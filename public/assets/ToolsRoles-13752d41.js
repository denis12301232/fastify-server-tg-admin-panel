import{Q as w}from"./QInput-6860a998.js";import{b as C,Q as T,a as d}from"./QTable-931fab52.js";import{Q as U}from"./QOptionGroup-28b68500.js";import{Q as I}from"./QPagination-33e1727d.js";import{u as R}from"./use-key-composition-a98e307f.js";import{d as S,r as i,w as L,n as N,a3 as f,e as t,b as l,k as _,a1 as B,o as v,g as b,a2 as g,f as V,p as M,i as j,_ as q}from"./index-06f4354f.js";import{T as y}from"./ToolsService-2c85bfb7.js";import"./focus-manager-e79c27be.js";import"./use-dark-70e23e67.js";import"./QList-86951a94.js";import"./QMarkupTable-ee18c591.js";import"./QCheckbox-927a42a8.js";import"./QChip-e5d00ce2.js";import"./QBtn-0e6d397d.js";import"./selection-9c6333d4.js";import"./QItemLabel-c04f9aef.js";import"./use-prevent-scroll-ecde5974.js";import"./scroll-5c350fea.js";import"./QDialog-bb3d94e8.js";import"./use-timeout-a2c402f4.js";import"./use-tick-e34f402d.js";import"./rtl-36dd996b.js";import"./format-7389883c.js";import"./QLinearProgress-4e78b85f.js";import"./uid-6a237b22.js";const z=s=>(M("data-v-051dd5bf"),s=s(),j(),s),D={class:"form"},E=z(()=>V("h5",{class:"title"},"Настроить роли пользователей",-1)),F={key:0,class:"row justify-center q-mt-md"},G=S({__name:"ToolsRoles",setup(s){const r=i(""),u=10,n=i(1),m=i(0),p=i([]);L(n,async()=>{const o=await y.getUsers(u,n.value);m.value=Math.ceil(+o.headers["x-total-count"]/u),p.value=o.data},{immediate:!0});const{f:h}=R({fn:y.updateRoles,alert:!0,successMsg:"Обновлено"}),x=N(()=>{var o;return(o=p.value)==null?void 0:o.filter(e=>e.login.toLowerCase().includes(r.value.toLowerCase())||e.name.toLowerCase().includes(r.value.toLowerCase()))}),Q=[{label:"Пользователь",value:"user",disable:!0},{label:"Админ",value:"admin"}],k=[{name:"name",label:"Имя",align:"left",field:"name",sortable:!0,sort:(o,e)=>o.localeCompare(e)},{name:"login",label:"Логин",align:"left",field:"login",sortable:!0,sort:(o,e)=>o.localeCompare(e)},{name:"roles",label:"Роль",align:"center",field:"roles"}];return(o,e)=>(v(),f("div",D,[E,t(w,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),outlined:"",label:"Поиск"},null,8,["modelValue"]),t(C,{class:"table",rows:_(x),columns:k,"binary-state-sort":"",separator:"cell","row-key":"index","hide-pagination":"","no-data-label":"Ничего не найдено"},{body:l(({row:a})=>[t(T,null,{default:l(()=>[t(d,{key:"name"},{default:l(()=>[b(g(a.name),1)]),_:2},1024),t(d,{key:"login"},{default:l(()=>[b(g(a.login),1)]),_:2},1024),t(d,{key:"roles","auto-width":""},{default:l(()=>[V("div",null,[t(U,{modelValue:a.roles,"onUpdate:modelValue":[c=>a.roles=c,c=>_(h)(a._id,a.roles)],type:"checkbox",options:Q},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024)]),_:2},1024)]),_:1},8,["rows"]),m.value>1?(v(),f("div",F,[t(I,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value=a),color:"grey-8",max:m.value,size:"sm"},null,8,["modelValue","max"])])):B("",!0)]))}});const fe=q(G,[["__scopeId","data-v-051dd5bf"]]);export{fe as default};
