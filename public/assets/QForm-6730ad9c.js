import{a4 as E,m as F,r as q,am as V,ae as I,af as Y,B as $,q as A,t as B,v as D,Y as P,C as R,ab as z}from"./index-9de4a442.js";import{b as M}from"./focus-manager-e79c27be.js";import{b as Q}from"./QBtn-c600b51e.js";class N{static required(e){return!!e}static isEmail(e){return/^(([a-z0-9]){4,}@([a-z]){2,}\.([a-z]){2,})$/i.test(e)}static isYYYYMMDD(e){return/^((1|2)(0|9)[0-9]{2})\/((0[1-9]{1})|(1[0-2]{1}))\/(([0-2]{1}[1-9]{1})|(3[0-1]{1}))$/.test(e)}static isPhone(e){return/^0([0-9]{9})$/.test(e)}static is10NumbersPhone(e){return/^0([0-9]{9})$/.test(e)}static isValidDistrict(e){return E.districts.includes(e)}static isYearInterval(e){return/^\d{4}-\d{4}$/.test(e)}static lengthInterval(e,l){return function(f){return f.length>=e&&f.length<=l}}}const T=F({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(a,{slots:e,emit:l}){const f=D(),u=q(null);let c=0;const i=[];function v(t){const s=typeof t=="boolean"?t:a.noErrorFocus!==!0,m=++c,x=(o,n)=>{l("validation"+(o===!0?"Success":"Error"),n)},p=o=>{const n=o.validate();return typeof n.then=="function"?n.then(r=>({valid:r,comp:o}),r=>({valid:!1,comp:o,err:r})):Promise.resolve({valid:n,comp:o})};return(a.greedy===!0?Promise.all(i.map(p)).then(o=>o.filter(n=>n.valid!==!0)):i.reduce((o,n)=>o.then(()=>p(n).then(r=>{if(r.valid===!1)return Promise.reject(r)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return m===c&&x(!0),!0;if(m===c){const{comp:n,err:r}=o[0];if(r!==void 0&&console.error(r),x(!1,n),s===!0){const S=o.find(({comp:C})=>typeof C.focus=="function"&&Q(C.$)===!1);S!==void 0&&S.comp.focus()}}return!1})}function b(){c++,i.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function h(t){t!==void 0&&P(t);const s=c+1;v().then(m=>{s===c&&m===!0&&(a.onSubmit!==void 0?l("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function y(t){t!==void 0&&P(t),l("reset"),R(()=>{b(),a.autofocus===!0&&a.noResetFocus!==!0&&d()})}function d(){M(()=>{if(u.value===null)return;const t=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),s=>s.tabIndex>-1);t!=null&&t.focus({preventScroll:!0})})}V(z,{bindComponent(t){i.push(t)},unbindComponent(t){const s=i.indexOf(t);s>-1&&i.splice(s,1)}});let g=!1;return I(()=>{g=!0}),Y(()=>{g===!0&&a.autofocus===!0&&d()}),$(()=>{a.autofocus===!0&&d()}),Object.assign(f.proxy,{validate:v,resetValidation:b,submit:h,reset:y,focus:d,getValidationComponents:()=>i}),()=>A("form",{class:"q-form",ref:u,onSubmit:h,onReset:y},B(e.default))}});export{T as Q,N as V};
